import sys
from map.PysharkPackage.parseRaport import *
from map.PysharkPackage.RCS_Exp import RCS_exp
from map.PysharkPackage import Configurate



# [in] - the capture file ( containing packets )
# return - if any packets had useful information => found_something = True, else False
# return - the full path to the .text raport ( Full_File_Name)
# return - the full path to the .json raport ( Full_JsonFile_Name )
# return - if the uploaded file is not a capture => wrong_Extension = True, else False
def runPyshark(captureFileName):
    found_something = False
    Full_File_Name = ""
    Full_JsonFile_Name = ""
    wrong_Extension = False
    try:
        obj1 = RCS_exp(captureFileName)
    except Exception as e:
        print('Exception in runPyshark 1')
        print(e)
    try:
        obj1.printPackets()
        raport = ParseRaport("sample.json")
        patterns = Configurate.readjson(Constants.Ptrn_file)
        found_something, Full_File_Name, Full_JsonFile_Name = raport.parse_JsonFull(patterns)
    except Exception as e:
        print('Exception in runPyshark 2')
        print(e)
        wrong_Extension = True
    return found_something, Full_File_Name, Full_JsonFile_Name, wrong_Extension












